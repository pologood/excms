KindEditor.plugin("importWord",function(e){var a,t;try{(a=content_mgr.indicatorId)||(a=0),t=GLOBAL_SITEID}catch(e){a=0,t=0}var l=this,i="importWord",n="../articleNews/uploadNew?siteId="+t+"&columnId="+a,o=e.undef(l.extraFileUploadParams,{}),d=e.undef(l.filePostName,"imgFile"),r=e.undef(l.fillDescAfterUploadImage,!1),c=l.lang(i+".");l.plugin.fileDialog2=function(a){a.imageUrl;var t=e.undef(a.showRemote,!0),u=e.undef(a.showLocal,!0),m=e.undef(a.tabIndex,0),p=a.clickFn,f="kindeditor_upload_iframe_"+(new Date).getTime(),s=[];for(var g in o)s.push('<input type="hidden" name="'+g+'" value="'+o[g]+'" />');var v,b=['<div style="padding:20px;">','<div class="tabs"></div>','<div class="tab2" style="display:none;">','<iframe name="'+f+'" style="display:none;"></iframe>','<form class="ke-upload-area ke-form" method="post" enctype="multipart/form-data" target="'+f+'" action="'+e.addParam(n,"dir=file")+'">','<div class="ke-dialog-row">',s.join(""),'<label style="width:60px;">'+c.localUrl+"</label>",'<input type="text" name="localUrl" class="ke-input-text" tabindex="-1" style="width:200px;" readonly="true" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+c.upload+'" />',"</div>","</form>","</div>","</div>"].join(""),h=u||allowFileManager?450:400,k=u&&t?300:250,y=l.createDialog({name:i,width:h,height:k,title:l.lang(i),body:b,yesBtn:{name:l.lang("yes"),click:function(e){if(!y.isLoading)return u&&t&&v&&0===v.selectedIndex||!t?""==D.fileBox.val()?void alert(l.lang("pleaseSelectFile")):(y.showLoading(l.lang("uploadLoading")),D.submit(),void w.val("")):void p.call(l,"title")}},beforeRemove:function(){x.unbind(),U.unbind()}}),I=y.div,w=e('[name="localUrl"]',I),x=e('[name="viewServer"]',I),U=e(".ke-refresh-btn",I);t&&u?((v=e.tabs({src:e(".tabs",I),afterSelect:function(e){}})).add({title:c.localImage,panel:e(".tab2",I)}),v.select(m)):u&&e(".tab2",I).show();var D=e.uploadbutton({button:e(".ke-upload-button",I)[0],fieldName:d,url:e.addParam(n,"dir=file"),extraParams:o,afterUpload:function(a){if(y.hideLoading(),0===a.error){var t=a.content;l.afterUpload&&l.afterUpload.call(l,t,a,i),r?(e(".ke-dialog-row #remoteUrl",I).val(t),e(".ke-tabs-li",I)[0].click(),e(".ke-refresh-btn",I).click()):p.call(l,t)}else alert(a.message)},afterError:function(e){y.hideLoading(),l.errorDialog(e)}});D.fileBox.change(function(e){w.val(D.fileBox.val())});var L=0,B=0;return U.click(function(a){tempImg.bind("load",function(){!function(e,a){L=e,B=a}(tempImg.width(),tempImg.height()),tempImg.remove()}),e(document.body).append(tempImg)}),y},l.plugin.fileUp={edit:function(){l.plugin.getSelectedImage();l.plugin.fileDialog2({clickFn:function(e){var a=e;l.insertHtml(a).hideDialog().focus()}})},delete:function(){var e=l.plugin.getSelectedImage();"a"==e.parent().name&&(e=e.parent()),e.remove(),l.addBookmark()}},l.clickToolbar(i,l.plugin.fileUp.edit)});