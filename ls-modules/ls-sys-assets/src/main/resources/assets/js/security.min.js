!function(s){if(void 0===s.RSAUtils)var M=s.RSAUtils={};var r,g,y,p=16,w=65536,x=w-1,S=s.BigInt=function(i){this.digits="boolean"==typeof i&&1==i?null:r.slice(0),this.isNeg=!1};M.setMaxDigits=function(i){r=new Array(i);for(var t=0;t<r.length;t++)r[t]=0;g=new S,(y=new S).digits[0]=1},M.setMaxDigits(20);M.biFromNumber=function(i){var t=new S;t.isNeg=i<0,i=Math.abs(i);for(var r=0;0<i;)t.digits[r++]=i&x,i=Math.floor(i/w);return t};var n=M.biFromNumber(1e15);M.biFromDecimal=function(i){for(var t,r="-"==i.charAt(0),e=r?1:0;e<i.length&&"0"==i.charAt(e);)++e;if(e==i.length)t=new S;else{var s=(i.length-e)%15;for(0==s&&(s=15),t=M.biFromNumber(Number(i.substr(e,s))),e+=s;e<i.length;)t=M.biAdd(M.biMultiply(t,n),M.biFromNumber(Number(i.substr(e,15)))),e+=15;t.isNeg=r}return t},M.biCopy=function(i){var t=new S(!0);return t.digits=i.digits.slice(0),t.isNeg=i.isNeg,t},M.reverseStr=function(i){for(var t="",r=i.length-1;-1<r;--r)t+=i.charAt(r);return t};var d=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];M.biToString=function(i,t){var r=new S;r.digits[0]=t;for(var e=M.biDivideModulo(i,r),s=d[e[1].digits[0]];1==M.biCompare(e[0],g);)e=M.biDivideModulo(e[0],r),digit=e[1].digits[0],s+=d[e[1].digits[0]];return(i.isNeg?"-":"")+M.reverseStr(s)},M.biToDecimal=function(i){var t=new S;t.digits[0]=10;for(var r=M.biDivideModulo(i,t),e=String(r[1].digits[0]);1==M.biCompare(r[0],g);)r=M.biDivideModulo(r[0],t),e+=String(r[1].digits[0]);return(i.isNeg?"-":"")+M.reverseStr(e)};var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];M.digitToHex=function(t){var r="";for(i=0;i<4;++i)r+=e[15&t],t>>>=4;return M.reverseStr(r)},M.biToHex=function(i){for(var t="",r=(M.biHighIndex(i),M.biHighIndex(i));-1<r;--r)t+=M.digitToHex(i.digits[r]);return t},M.charToHex=function(i){return 48<=i&&i<=57?i-48:65<=i&&i<=90?10+i-65:97<=i&&i<=122?10+i-97:0},M.hexToDigit=function(i){for(var t=0,r=Math.min(i.length,4),e=0;e<r;++e)t<<=4,t|=M.charToHex(i.charCodeAt(e));return t},M.biFromHex=function(i){for(var t=new S,r=i.length,e=0;0<r;r-=4,++e)t.digits[e]=M.hexToDigit(i.substr(Math.max(r-4,0),Math.min(r,4)));return t},M.biFromString=function(i,t){var r="-"==i.charAt(0),e=r?1:0,s=new S,g=new S;g.digits[0]=1;for(var n=i.length-1;e<=n;n--){var d=i.charCodeAt(n),o=M.charToHex(d),u=M.biMultiplyDigit(g,o);s=M.biAdd(s,u),g=M.biMultiplyDigit(g,t)}return s.isNeg=r,s},M.biDump=function(i){return(i.isNeg?"-":"")+i.digits.join(" ")},M.biAdd=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=M.biSubtract(i,t),t.isNeg=!t.isNeg;else{r=new S;for(var e,s=0,g=0;g<i.digits.length;++g)e=i.digits[g]+t.digits[g]+s,r.digits[g]=e%w,s=Number(w<=e);r.isNeg=i.isNeg}return r},M.biSubtract=function(i,t){var r;if(i.isNeg!=t.isNeg)t.isNeg=!t.isNeg,r=M.biAdd(i,t),t.isNeg=!t.isNeg;else{var e,s;r=new S;for(var g=s=0;g<i.digits.length;++g)e=i.digits[g]-t.digits[g]+s,r.digits[g]=e%w,r.digits[g]<0&&(r.digits[g]+=w),s=0-Number(e<0);if(-1==s){for(g=s=0;g<i.digits.length;++g)e=0-r.digits[g]+s,r.digits[g]=e%w,r.digits[g]<0&&(r.digits[g]+=w),s=0-Number(e<0);r.isNeg=!i.isNeg}else r.isNeg=i.isNeg}return r},M.biHighIndex=function(i){for(var t=i.digits.length-1;0<t&&0==i.digits[t];)--t;return t},M.biNumBits=function(i){var t,r=M.biHighIndex(i),e=i.digits[r],s=(r+1)*p;for(t=s;s-p<t&&0==(32768&e);--t)e<<=1;return t},M.biMultiply=function(i,t){for(var r,e,s,g=new S,n=M.biHighIndex(i),d=M.biHighIndex(t),o=0;o<=d;++o){for(r=0,s=o,j=0;j<=n;++j,++s)e=g.digits[s]+i.digits[j]*t.digits[o]+r,g.digits[s]=e&x,r=e>>>16;g.digits[o+n+1]=r}return g.isNeg=i.isNeg!=t.isNeg,g},M.biMultiplyDigit=function(i,t){var r,e,s;result=new S,r=M.biHighIndex(i);for(var g=e=0;g<=r;++g)s=result.digits[g]+i.digits[g]*t+e,result.digits[g]=s&x,e=s>>>16;return result.digits[1+r]=e,result},M.arrayCopy=function(i,t,r,e,s){for(var g=Math.min(t+s,i.length),n=t,d=e;n<g;++n,++d)r[d]=i[n]};var o=[0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535];M.biShiftLeft=function(i,t){var r=Math.floor(t/p),e=new S;M.arrayCopy(i.digits,0,e.digits,r,e.digits.length-r);for(var s=t%p,g=p-s,n=e.digits.length-1,d=n-1;0<n;--n,--d)e.digits[n]=e.digits[n]<<s&x|(e.digits[d]&o[s])>>>g;return e.digits[0]=e.digits[n]<<s&x,e.isNeg=i.isNeg,e};var u=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function a(i){var t=M,r=t.biDivideByRadixPower(i,this.k-1),e=t.biMultiply(r,this.mu),s=t.biDivideByRadixPower(e,this.k+1),g=t.biModuloByRadixPower(i,this.k+1),n=t.biMultiply(s,this.modulus),d=t.biModuloByRadixPower(n,this.k+1),o=t.biSubtract(g,d);o.isNeg&&(o=t.biAdd(o,this.bkplus1));for(var u=0<=t.biCompare(o,this.modulus);u;)o=t.biSubtract(o,this.modulus),u=0<=t.biCompare(o,this.modulus);return o}function b(i,t){var r=M.biMultiply(i,t);return this.modulo(r)}function l(i,t){var r=new S;r.digits[0]=1;for(var e=i,s=t;0!=(1&s.digits[0])&&(r=this.multiplyMod(r,e)),0!=(s=M.biShiftRight(s,1)).digits[0]||0!=M.biHighIndex(s);)e=this.multiplyMod(e,e);return r}M.biShiftRight=function(i,t){var r=Math.floor(t/p),e=new S;M.arrayCopy(i.digits,r,e.digits,0,i.digits.length-r);for(var s=t%p,g=p-s,n=0,d=n+1;n<e.digits.length-1;++n,++d)e.digits[n]=e.digits[n]>>>s|(e.digits[d]&u[s])<<g;return e.digits[e.digits.length-1]>>>=s,e.isNeg=i.isNeg,e},M.biMultiplyByRadixPower=function(i,t){var r=new S;return M.arrayCopy(i.digits,0,r.digits,t,r.digits.length-t),r},M.biDivideByRadixPower=function(i,t){var r=new S;return M.arrayCopy(i.digits,t,r.digits,0,r.digits.length-t),r},M.biModuloByRadixPower=function(i,t){var r=new S;return M.arrayCopy(i.digits,0,r.digits,0,t),r},M.biCompare=function(i,t){if(i.isNeg!=t.isNeg)return 1-2*Number(i.isNeg);for(var r=i.digits.length-1;0<=r;--r)if(i.digits[r]!=t.digits[r])return i.isNeg?1-2*Number(i.digits[r]>t.digits[r]):1-2*Number(i.digits[r]<t.digits[r]);return 0},M.biDivideModulo=function(i,t){var r,e,s=M.biNumBits(i),g=M.biNumBits(t),n=t.isNeg;if(s<g)return i.isNeg?((r=M.biCopy(y)).isNeg=!t.isNeg,i.isNeg=!1,t.isNeg=!1,e=biSubtract(t,i),i.isNeg=!0,t.isNeg=n):(r=new S,e=M.biCopy(i)),[r,e];r=new S,e=i;for(var d=Math.ceil(g/p)-1,o=0;t.digits[d]<32768;)t=M.biShiftLeft(t,1),++o,++g,d=Math.ceil(g/p)-1;e=M.biShiftLeft(e,o),s+=o;for(var u=Math.ceil(s/p)-1,a=M.biMultiplyByRadixPower(t,u-d);-1!=M.biCompare(e,a);)++r.digits[u-d],e=M.biSubtract(e,a);for(var b=u;d<b;--b){var l=b>=e.digits.length?0:e.digits[b],h=b-1>=e.digits.length?0:e.digits[b-1],f=b-2>=e.digits.length?0:e.digits[b-2],v=d>=t.digits.length?0:t.digits[d],c=d-1>=t.digits.length?0:t.digits[d-1];r.digits[b-d-1]=l==v?x:Math.floor((l*w+h)/v);for(var N=r.digits[b-d-1]*(v*w+c),m=4294967296*l+(h*w+f);m<N;)--r.digits[b-d-1],N=r.digits[b-d-1]*(v*w|c),m=l*w*w+(h*w+f);a=M.biMultiplyByRadixPower(t,b-d-1),(e=M.biSubtract(e,M.biMultiplyDigit(a,r.digits[b-d-1]))).isNeg&&(e=M.biAdd(e,a),--r.digits[b-d-1])}return e=M.biShiftRight(e,o),r.isNeg=i.isNeg!=n,i.isNeg&&(r=n?M.biAdd(r,y):M.biSubtract(r,y),t=M.biShiftRight(t,o),e=M.biSubtract(t,e)),0==e.digits[0]&&0==M.biHighIndex(e)&&(e.isNeg=!1),[r,e]},M.biDivide=function(i,t){return M.biDivideModulo(i,t)[0]},M.biModulo=function(i,t){return M.biDivideModulo(i,t)[1]},M.biMultiplyMod=function(i,t,r){return M.biModulo(M.biMultiply(i,t),r)},M.biPow=function(i,t){for(var r=y,e=i;0!=(1&t)&&(r=M.biMultiply(r,e)),0!=(t>>=1);)e=M.biMultiply(e,e);return r},M.biPowMod=function(i,t,r){for(var e=y,s=i,g=t;0!=(1&g.digits[0])&&(e=M.biMultiplyMod(e,s,r)),0!=(g=M.biShiftRight(g,1)).digits[0]||0!=M.biHighIndex(g);)s=M.biMultiplyMod(s,s,r);return e},s.BarrettMu=function(i){this.modulus=M.biCopy(i),this.k=M.biHighIndex(this.modulus)+1;var t=new S;t.digits[2*this.k]=1,this.mu=M.biDivide(t,this.modulus),this.bkplus1=new S,this.bkplus1.digits[this.k+1]=1,this.modulo=a,this.multiplyMod=b,this.powMod=l};var h=function(i,t,r){var e=M;this.e=e.biFromHex(i),this.d=e.biFromHex(t),this.m=e.biFromHex(r),this.chunkSize=2*e.biHighIndex(this.m),this.radix=16,this.barrett=new s.BarrettMu(this.m)};M.getKeyPair=function(i,t,r){return new h(i,t,r)},void 0===s.twoDigit&&(s.twoDigit=function(i){return(i<10?"0":"")+String(i)}),M.encryptedString=function(i,t){for(var r=[],e=t.length,s=0;s<e;)r[s]=t.charCodeAt(s),s++;for(;r.length%i.chunkSize!=0;)r[s++]=0;var g,n,d,o=r.length,u="";for(s=0;s<o;s+=i.chunkSize){for(d=new S,g=0,n=s;n<s+i.chunkSize;++g)d.digits[g]=r[n++],d.digits[g]+=r[n++]<<8;var a=i.barrett.powMod(d,i.e);u+=(16==i.radix?M.biToHex(a):M.biToString(a,i.radix))+" "}return u.substring(0,u.length-1)},M.decryptedString=function(i,t){var r,e,s,g=t.split(" "),n="";for(r=0;r<g.length;++r){var d;for(d=16==i.radix?M.biFromHex(g[r]):M.biFromString(g[r],i.radix),s=i.barrett.powMod(d,i.d),e=0;e<=M.biHighIndex(s);++e)n+=String.fromCharCode(255&s.digits[e],s.digits[e]>>8)}return 0==n.charCodeAt(n.length-1)&&(n=n.substring(0,n.length-1)),n},M.setMaxDigits(130)}(window);