var App=function(){var e,t,i=!1,n=!1,o=!1,s=[],r=!1,c=(t={xs:480,sm:768,md:992,lg:1200})[e="md"]?t[e]:0,d=function(){for(var e=0;e<s.length;e++){s[e].call()}},l=function(){App.initSlimScroll(".scroller")},h=function(){$("[data-auto-height]").each(function(){var e=$(this),t=$("[data-height]",e),a=0,i=e.attr("data-mode"),n=parseInt(e.attr("data-offset")?e.attr("data-offset"):0);t.each(function(){"height"==$(this).attr("data-height")?$(this).css("height",""):$(this).css("min-height","");var e="base-height"==i?$(this).outerHeight():$(this).outerHeight(!0);a<e&&(a=e)}),a+=n,t.each(function(){"height"==$(this).attr("data-height")?$(this).css("height",a):$(this).css("min-height",a)}),e.attr("data-related")&&$(e.attr("data-related")).css("height",e.height())})},p=function(){var i,e=$(".page-content"),t=$(".page-sidebar"),a=$(".page-header").outerHeight(),n=$(".page-content-body",e),o=$("body");if(!0===o.hasClass("page-footer-fixed")&&!1===o.hasClass("page-sidebar-fixed")){var s=App.getViewPort().height-a;e.height()<s&&(e.css("min-height",s),n.height(s))}else o.hasClass("page-sidebar-fixed")?i=g():(i=App.getViewPort().width<c?App.getViewPort().height-a:t.height()+20)+a<=App.getViewPort().height&&(i=App.getViewPort().height-a),e.css("min-height",i),n.height(i);var r=$(".page-content .page-content-body .mini-datagrid");setTimeout(function(){$.each(r,function(e,t){var a=$(t).attr("id");m(a,el,i)})},100)},g=function(){var e=App.getViewPort().height-$(".page-header").outerHeight(!0);return $("body").hasClass("page-footer-fixed")&&(e-=$(".page-footer").outerHeight()),e},a=function(){var e=$(".page-sidebar-menu");if(0!==$(".page-sidebar-fixed").size()){var t=g();e.attr("data-height",t),$(".page-sidebar").attr("style","height:"+g()+"px !important"),$(".page-sidebar").mCustomScrollbar({theme:"minimal",axis:"yx"}),p()}else p()},u=function(){var e=$("body");e.hasClass("page-sidebar-fixed")&&$(".page-sidebar").on("mouseenter",function(){e.hasClass("page-sidebar-closed")&&$(this).find(".page-sidebar-menu").removeClass("page-sidebar-menu-closed")}).on("mouseleave",function(){e.hasClass("page-sidebar-closed")&&$(this).find(".page-sidebar-menu").addClass("page-sidebar-menu-closed")})},f=function(){$(".full-height-content").each(function(){var e,t=$(this);if(e=App.getViewPort().height-$(".page-header").outerHeight(!0)-$(".page-title").outerHeight(!0)-$(".page-bar").outerHeight(!0),t.hasClass("portlet")){var a=t.find(".portlet-body");App.destroySlimScroll(a.find(".full-height-content-body")),e=e-t.find(".portlet-title").outerHeight(!0)-parseInt(t.find(".portlet-body").css("padding-top"))-parseInt(t.find(".portlet-body").css("padding-bottom"))-5,App.getViewPort().width>=c&&t.hasClass("full-height-content-scrollable")?(e-=35,a.find(".full-height-content-body").css("height",e),App.initSlimScroll(a.find(".full-height-content-body"))):a.css("min-height",e)}else App.destroySlimScroll(t.find(".full-height-content-body")),App.getViewPort().width>=c&&t.hasClass("full-height-content-scrollable")?(e-=35,t.find(".full-height-content-body").css("height",e),App.initSlimScroll(t.find(".full-height-content-body"))):t.css("min-height",e)})},m=function(e,t,a){try{var i=mini.get(e);if(i){var n=$(i.el),o=i.columns,s=n.outerWidth(),r=0,d=[];if($.each(o,function(e,t){var a=(t.cellStyle||"").match(/min-width:(.*?[^;]+)/);"100%"==t.width||a?null==a?(r+=320,t.cellStyle="min-width:320",d.push({index:t._index,width:320})):(r+=parseInt(a[1]),d.push({index:t._index,width:parseInt(a[1])})):r+=parseInt(t.width)}),0<d.length&&s<r)for(var l=0,c=d.length;l<c;l++){var h=d[l],p=i.getColumn(h.index);i.setColumnWidth(p,h.width)}else for(l=0,c=d.length;l<c;l++){h=d[l],p=i.getColumn(h.index);i.setColumnWidth(p,"100%")}n.hasClass("no-auto-height")||i.setHeight(a-n.prev().outerHeight(!0)-45)}}catch(e){Ls.log(e)}};return{init:function(){var e,t,a=this;i=!!navigator.userAgent.match(/MSIE 8.0/),n=!!navigator.userAgent.match(/MSIE 9.0/),(o=!!navigator.userAgent.match(/MSIE 10.0/))&&$("html").addClass("ie10"),(o||n||i)&&$("html").addClass("ie"),i?$(window).resize(function(){t!=document.documentElement.clientHeight&&(e&&clearTimeout(e),e=setTimeout(function(){d()},50),t=document.documentElement.clientHeight)}):$(window).resize(function(){e&&clearTimeout(e),e=setTimeout(function(){d()},50)}),l(),h(),a.addResizeHandler(h),(i||n)&&$("input[placeholder]:not(.placeholder-no-fix), textarea[placeholder]:not(.placeholder-no-fix)").each(function(){var e=$(this);""===e.val()&&""!==e.attr("placeholder")&&e.addClass("placeholder").val(e.attr("placeholder")),e.focus(function(){e.val()==e.attr("placeholder")&&e.val("")}),e.blur(function(){""!==e.val()&&e.val()!=e.attr("placeholder")||e.val(e.attr("placeholder"))})}),a.initHeader(),a.initSidebar(),a.initContent(),a.initPushState()},initAjax:function(){l(),jQuery.fancybox&&0<$(".fancybox-button").size()&&$(".fancybox-button").fancybox({groupAttr:"data-rel",prevEffect:"none",nextEffect:"none",closeBtn:!0,helpers:{title:{type:"inside"}}}),$(".tooltips").tooltip()},initHeader:function(){$(".page-header").on("click",'.hor-menu a[data-toggle="tab"]',function(e){e.preventDefault();var t=$(".hor-menu .nav").find("li.current");$("li.active",t).removeClass("active"),$(".selected",t).remove();var a=$(this).parents("li").last();a.addClass("current"),a.find("a:first").append('<span class="selected"></span>')}),$(".page-header").on("click",".search-form",function(e){$(this).addClass("open"),$(this).find(".form-control").focus(),$(".page-header .search-form .form-control").on("blur",function(e){$(this).closest(".search-form").removeClass("open"),$(this).unbind("blur")})}),$(".page-header").on("keypress",".hor-menu .search-form .form-control",function(e){if(13==e.which)return $(this).closest(".search-form").submit(),!1}),$(".page-header").on("mousedown",".search-form.open .submit",function(e){e.preventDefault(),e.stopPropagation(),$(this).closest(".search-form").submit()}),$('[data-hover="megamenu-dropdown"]').not(".hover-initialized").each(function(){$(this).addClass("hover-initialized")}),$(document).on("click",".mega-menu-dropdown .dropdown-menu",function(e){e.stopPropagation()}),$(".hor-menu-top").on("click","li",function(e){var t=$(this),a=t.data("id");t.addClass("active").siblings().removeClass("active"),$(".top-more span").first().text("更 多"),$(".top-more li").removeClass("active"),$(".top-more>a").removeClass("active"),$(".menu-item").hide();var i=$(".menu_"+a);r?(i.first().find("[href='/searchBody']").trigger("click",[{isTrigger:!0}]),r=!r):i.first().find(".ajaxify:first").trigger("click",[{isTrigger:!0}]),i.show(),e.stopPropagation()})},initSidebar:function(){var i;a(),$(".page-sidebar-menu").on("click","li > a.nav-toggle",function(e){var t=$(this).closest(".nav-item").children(".nav-link");if(!(App.getViewPort().width>=c&&!$(".page-sidebar").attr("data-initialized")&&$("body").hasClass("page-sidebar-closed")&&1===t.parent("li").parent(".page-sidebar-menu").size())){var a=t.next().hasClass("sub-menu");if(!(App.getViewPort().width>=c&&1===t.parents(".page-sidebar-menu-hover-submenu").size()))if(!1!==a){if(!t.next().hasClass("sub-menu always-open")){var i=t.parent().parent(),n=t,o=$(".page-sidebar-menu"),s=t.next(),r=o.data("auto-scroll"),d=parseInt(o.data("slide-speed")),l=o.data("keep-expanded");GLOBAL_RIGHTS,l||(i.children("li.open").children("a").children(".arrow").removeClass("open"),i.children("li.open").children(".sub-menu:not(.always-open)").slideUp(d),i.children("li.open").removeClass("open")),s.is(":visible")?($(".arrow",n).removeClass("open"),n.parent().removeClass("open"),s.slideUp(d,function(){!0===r&&!1===$("body").hasClass("page-sidebar-closed")&&($("body").hasClass("page-sidebar-fixed")||App.scrollTo(n,-200)),p()})):a&&($(".arrow",n).addClass("open"),n.parent().addClass("open"),s.slideDown(d,function(){!0===r&&!1===$("body").hasClass("page-sidebar-closed")&&($("body").hasClass("page-sidebar-fixed")?$(".page-sidebar").mCustomScrollbar("scrollTo",n.position().top):App.scrollTo(n,-200)),p()})),e.preventDefault()}}else App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click()}}),$(".page-sidebar").on("click"," li > a.ajaxify",function(n,o){n.preventDefault(),App.scrollTop();var s=$(this).attr("href"),r=$(this).data("id"),e=$(".page-sidebar ul"),d=$(".page-content .page-content-body");e.children("li.active").removeClass("active"),e.children("arrow.open").removeClass("open"),e.children("li.open").removeClass("open").children(".sub-menu").hide(),$(this).parents("li").each(function(){var e=$(this);e.addClass("active open"),e.children("ul.sub-menu").show(),e.children("a > span.arrow").addClass("open")}),App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click(),App.startPageLoading();var l=$(this);try{$("body").off("click.lightbox,mousedown.lightbox")}catch(n){}Ls.ajax({url:"/getMenuSiteId",data:{indicatorId:r.replace(/sm_|m_/g,"")}}).done(function(e){var t=e.data;if(t&&(GLOBAL_SITEID=t.indicatorId,GLOBAL_SITETYPE=t.type,GLOBAL_SITENAME=t.name,GLOBAL_SITEURI=t.uri,GLOBAL_HTMLFILEPATH=t.uri),App.getContentAjax(s+(/\?/.test(s)?"&":"?")+"menuId="+r.replace(/sm_|m_/g,"")).done(function(e){0===l.parents("li.open").size()&&$(".page-sidebar-menu > li.open > a").click(),App.stopPageLoading(),d.html(e),p(),App.initAjax()}).fail(function(e,t,a){App.stopPageLoading(),d.html("<h4>Could not load the requested content.</h4>")}),Ls.browser.isIE9OrLower)window.location.hash=Ls.base64.encode(r+"");else if(history.pushState){var a=Ls.base64.encode(r+""),i="#"+a;a&&(/\d/.test(n.button)||o)&&history.pushState({hash:a},"",i)}})}),$(".page-content").on("click",".ajaxify",function(e){e.preventDefault(),App.scrollTop();var t=$(this).attr("href"),i=$(".page-content .page-content-body");App.startPageLoading(),App.getViewPort().width<c&&$(".page-sidebar").hasClass("in")&&$(".page-header .responsive-toggler").click(),App.getContentAjax($.trim(t)).done(function(e){App.destroyEcharts(),App.stopPageLoading(),i.html(e),p(),App.initAjax()}).fail(function(e,t,a){i.html("<h4>Could not load the requested content.</h4>"),App.stopPageLoading()})}),$(document).on("click",".page-header-fixed-mobile .page-header .responsive-toggler",function(){App.scrollTop()}),u(),$(".page-sidebar").on("click",".sidebar-search .remove",function(e){e.preventDefault(),$(".sidebar-search").removeClass("open")}),$(".page-sidebar .sidebar-search").on("keypress","input.form-control",function(e){if(13==e.which)return $(".sidebar-search").submit(),!1}),$(".sidebar-search .submit").on("click",function(e){e.preventDefault(),$("body").hasClass("page-sidebar-closed")&&!1===$(".sidebar-search").hasClass("open")?(1===$(".page-sidebar-fixed").size()&&$(".page-sidebar .sidebar-toggler").click(),$(".sidebar-search").addClass("open")):$(".sidebar-search").submit()}),0!==$(".sidebar-search").size()&&($(".sidebar-search .input-group").on("click",function(e){e.stopPropagation()}),$("body").on("click",function(){$(".sidebar-search").hasClass("open")&&$(".sidebar-search").removeClass("open")})),i=$("body"),$.cookie&&"1"===$.cookie("sidebar_closed")&&App.getViewPort().width>=c&&($("body").addClass("page-sidebar-closed"),$(".page-sidebar-menu").addClass("page-sidebar-menu-closed")),$("body").on("click",".sidebar-toggler",function(e){var t=$(".page-sidebar"),a=$(".page-sidebar-menu");$(".sidebar-search",t).removeClass("open"),i.hasClass("page-sidebar-closed")?(i.removeClass("page-sidebar-closed"),a.removeClass("page-sidebar-menu-closed"),$.cookie&&$.cookie("sidebar_closed","0")):(i.addClass("page-sidebar-closed"),a.addClass("page-sidebar-menu-closed"),i.hasClass("page-sidebar-fixed")&&a.trigger("mouseleave"),$.cookie&&$.cookie("sidebar_closed","1")),$(window).trigger("resize")}),App.addResizeHandler(a)},initContent:function(){f(),$("body").on("shown.bs.tab",'a[data-toggle="tab"]',function(){p()}),App.addResizeHandler(p),App.addResizeHandler(f)},initPushState:function(){Ls.browser.isIE9OrLower||history.pushState&&(window.onpopstate=function(e){var t=e.state;if(t){var a=$(".page-sidebar-menu a[hash='"+t.hash+"']");if(0<a.length){var i=a.closest(".menu-item").data("pid");$("#hor_menu_"+i).addClass("active").siblings().removeClass("active"),$(".left-menu").hide(),$(".left-menu-"+i).show(),a.click()}}})},initEchartsResize:function(e){s.push(e)},addResizeHandler:function(e){s.push(e)},runResizeHandlers:function(){d()},fixContentHeight:function(){p()},destroyEcharts:function(){var a=[];$.each(s,function(e,t){t&&"echartResize"!==t.name&&a.push(t)}),s=a.concat([])},scrollTo:function(e,t){var a=e&&0<e.size()?e.offset().top:0;e&&($("body").hasClass("page-header-fixed")?a-=$(".page-header").height():$("body").hasClass("page-header-top-fixed")?a-=$(".page-header-top").height():$("body").hasClass("page-header-menu-fixed")&&(a-=$(".page-header-menu").height()),a+=t||-1*e.height()),$("html,body").animate({scrollTop:a},"slow")},initSlimScroll:function(e,t){$(e).each(function(){var e=$(this);e.data("initialized")||(e.attr("data-height")?e.css("height",e.attr("data-height")):e.css("height"),t?e.mCustomScrollbar($.extend({theme:"minimal-dark",axis:"yx"},t)):e.mCustomScrollbar({theme:"minimal-dark",axis:"yx"}),0<e.find(".ztree").length&&e.find(".ztree").css("height","auto"),e.data("initialized","1"))})},destroySlimScroll:function(e){$().slimScroll&&$(e).each(function(){var e=$(this);if("1"===e.attr("data-initialized")){e.removeAttr("data-initialized"),e.removeAttr("style");var t={};e.attr("data-handle-color")&&(t["data-handle-color"]=e.attr("data-handle-color")),e.attr("data-wrapper-class")&&(t["data-wrapper-class"]=e.attr("data-wrapper-class")),e.attr("data-rail-color")&&(t["data-rail-color"]=e.attr("data-rail-color")),e.attr("data-always-visible")&&(t["data-always-visible"]=e.attr("data-always-visible")),e.attr("data-rail-visible")&&(t["data-rail-visible"]=e.attr("data-rail-visible")),e.slimScroll({wrapperClass:e.attr("data-wrapper-class")?e.attr("data-wrapper-class"):"slimScrollDiv",destroy:!0});var a=e;$.each(t,function(e,t){a.attr(e,t)})}})},scrollTop:function(){App.scrollTo()},startPageLoading:function(e){e&&e.animate?($(".page-spinner-bar").remove(),$("body").append('<div class="page-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>')):($(".page-loading").remove(),$("body").append('<div class="page-loading"><img src="/assets/images/loading-spinner-grey.gif"/>&nbsp;&nbsp;<span>'+(e&&e.message?e.message:"Loading...")+"</span></div>"))},stopPageLoading:function(){$(".page-loading, .page-spinner-bar").remove()},getViewPort:function(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}},getUniqueID:function(e){return"prefix_"+Math.floor(Math.random()*(new Date).getTime())},getContentAjax:function(e,t){return t=$.extend(!0,{cache:!1,url:e,dataType:"html",data:"",beforeSend:function(){}},t),Ls.ajaxGet(t)},getContentHtml:function(e,t){var i=$(".page-content .page-content-body");return this.getContentAjax(e,t).done(function(e){App.destroyEcharts(),i.html(e)}).fail(function(e,t,a){i.html("<h4>Could not load the requested content.</h4>")})},initScroll:function(e,t){if($().perfectScrollbar)return e?(e.css($.extend(!0,{position:"relative"},t)),e.mCustomScrollbar({theme:"minimal-dark",axis:"yx"})):void 0},initContentScroll:function(e,t,a){var i=$(t||".ztree"),n=$("#page_content");n=0<n.length?n:$(document),App.initScroll(i,{height:e||n.outerHeight()-10}),0<i.closest(".mini-layout-region-body").length&&i.closest(".mini-layout-region-body").css("overflow","inherit"),a&&(a.right&&i.children().eq(1).css("right","string"==typeof a.right?a.right:"-20px"),a.bottom&&i.children().last().css("bottom","string"==typeof a.bottom?a.bottom:"-15px"),i.parent().css("padding","5px 15px 5px 5px"))},destroyScroll:function(e){$(e).mCustomScrollbar("destroy")},globalSearch:function(){r=!0,$(".hor-menu-top li:first").click()}}}();$(document).ready(function(){App.init()});